/**
 * Copyright (c) Benjamin Ansbach - all rights reserved.
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

const P_INITIALIZATION_DATA = Symbol('__initialization_data');

/**
 * Abstract class for RPC response objects.
 */
class Abstract {
  /**
     * Constructor.
     *
   * @param {Object} initializationData
     */
  constructor(initializationData) {
    if (new.target === Abstract) {
      throw new TypeError('Cannot construct Abstract instances directly');
    }

    this[P_INITIALIZATION_DATA] = initializationData;
  }

  /**
     * Gets the initialization data. This should normally not be used at all but
     * in case there are new fields which are not implemented in the library yet,
     * the user will still have access to it.
     *
     * @returns {Object}
     */
  get __initializationData() {
    return this[P_INITIALIZATION_DATA];
  }

  mapInitializationDataWithProperties(props) {
    let mapped = {};

    props.forEach(prop => {
      let origin = prop.description;
      if(prop.description.indexOf('.') > -1) {
        origin = prop.description.split('.')[0];
      }

      if (this[P_INITIALIZATION_DATA][origin] !== undefined) {
        mapped[prop] = this[P_INITIALIZATION_DATA][origin];
      }
    });

    return mapped;
  }
}

module.exports = Abstract;
